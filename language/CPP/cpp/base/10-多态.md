## 多态

**函数重写**

* 在子类中定义与父类中原型相同的函数
* 函数重写只发生在父类与子类之间

**函数重写的结果**

* **默认情况下**:子类中重写的函数将隐藏父类中的函数
* 通过作用域符可以访问到父类中被隐藏的函数

C++通过`virtual`关键字对多态进行支持.

### 多态的意义

* 封装：突破了C语言函数的概念
* 继承：代码复用
* 多态：可以使用未来的

**多态成立的条件**

* 1.有继承
* 2.要有函数重写。。。c虚函数
* 3.要有父指针(父类引用)指向子类对象

**多态的理论基础**

* 动态联编和静态联编
	* 1.联编：指一个程序模块、代码之间互相关联的过程。
	* 2.静态联编：程序匹配、连接在编译阶段实现(重载函数的使用静态联编)
	* 3.动态联编：是指程序联编推迟到运行时进行(switch和if语句)
#### 多态的实现原理

* 当类中声明虚函数时，编译器会在类中生成一个虚函数表
* 虚函数表是一个存储类成员函数指针的结构体
* 虚函数表是由编译器自动生成与维护的
* `virtual`成员函数会被编译器放入虚函数表中
* 当存在虚函数时，每个对象中都有一个指向虚函数表的指针(C++编译器给父类对象、子类对象提前布局vptr指针)
* VPTR一般作为类对象的第一个成员

#### 构造函数中调用虚函数，多态?

* 对象中的VPTR在对象创建时，由编译器对VPTR指针进行初始化
* 只有当对象的构造完全结束后VPTR的指向才能最终确定。
* 父对象的VPTR指向父类虚函数表
* 子类对象的VPTR指向子类虚函数表
