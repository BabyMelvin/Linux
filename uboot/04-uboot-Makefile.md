# 1.源码配置
uboot复杂项目，不能直接编译，先配置才能编译 `make x210_sd_config`，配置完成就可以`make -j4`

# 2.Makefile学习
## 2.1 版本号

```
//24-29行
u_boot_version(U_BOOT_VERSION=$(VERSION).$(PATCHLEVEL).$(SUBLEVEL).$(EXTRAVERSION))

//uboot版本 1.3.4
VERSION =1 
PATCHLEVEL = 3
SUBLEVEL = 4
EXTRAVERSION = 

VERSION_FILE=$(obj)include/version_autogenerated.h
```

//VERSION_FILE，是根据makefile中的365行的规则创建的

```makefile
$(VERSION_FILE):
	@(printf '#define U_BOOT_VERSION "U-Boot %s%s\n' "$(U_BOOT_VERSION)" \
	 '$(shell $(CONFIG_SHELL) $(TOPDIR)/tools/setlocalversion $(TOPDIR))' \
	 ) >$@.tmp
	 @cmp -s $@ $@.tmp && rm -f $@.tmp || mv -f $@.tmp $@)
```
将会自动在include目录下生成version_autogenerated.h文件，其内容为`#define U_BOOT_VERSION "U-Boot 1.3.4"`

# 2.2主机操作系统和主机架构

```
HOSTARCH :=$(shell uname -m | \
sed -e s/i.86/i386/\
	-e s/sun4u/sparc64/ \
	-e s/arm.*/arm/ \
	-e s/sa110/arm/ \
	-e s/powerpc/ppc/ \
	-e s/ppc64/ppc/ \
	-e s/macppc/ppc/)
HOSTOS :=$(shell uname -s | tr '[:upper]''[:lower]'|\
	sed -e 's/\(cygwin\).*/cygwin/')

export HOSTARCH HOSTOS //导出CPU架构和CPU操作系统
```
ARCH:architecture

## 2.3静默编译

静默编译就是没有编译输出

```
#Deal with colliding definitions from tcsh etc:
VERSION = 
##############################################
#Allow for silent builds
ifeq (,$(findstring s,$(MAKEFILEFLAGS))))//是否有s的编译选项
XECHO = echo 
else
XECHO = ：
endif
```

`make -s`:就是进行静默编译