# 1.冯诺依曼体系和CPU工作原理
现代计算机，大部分都是基于冯诺依曼体系结构，而我们这里谈论的也是此问前提。冯诺依曼的核心是：**存储程序**，**顺序执行**。所以不管计算机如何发展，基本原理是相同的。**计算机程序实际上是告诉计算机做什么**。

冯诺依曼体系结构有以下特点：

* 计算机处理的数据和指令一律用二进制数表示；
* 指令和数据不加区别混合存储在同一个存储器中;
* 顺序执行程序的每一条指令
* 计算机硬件由`运算器`、`控制器`、`存储器`、`输入设备和输出设备`五大部分组成

冯诺依曼体系结构的计算机必须具有如下功能：

* 把需要的程序和数据送至计算机中
* 必须具有长期记忆程序、数据、中间结果及最终运算结果的能力
* 能够完成各种算术、逻辑运算和数据传送等数据加工处理的能力
* 能够根据需要控制程序走向，并能根据指令控制机器的各部件协调操作
* 能够按照要求将处理结果输出给用户

![](image/20130828001944015)

#  2.计算机工作原理
对于我们现代计算机来说，最关键的2个部件就是CPU和内存。内存存储了要执行的程序指令，而CPU就是用来执行这些指令。CPU首先要知道这些指定存放在存储器的那个区域，然后才能执行，并且把执行的结果写入到执行区域。

## 2.1 CPU指令和编程语言
在了解CPU和存储器工作原理之前，先来了解一下CPU指令和我们编程语言之间的一些关系。

 ### 2.1.1 CPU指令
CPU指令其实就对应了我们这里说的0和1的一些组合。每款CPU在设计时就规定了一系列与其硬件电路相配合的指令系统。有了CPU指令集的文档你就可以通过这个编写CPU认识的机器代码了。所以对于不同CPU来说可能会有不同的机器码。

随着计算机的发展，CPU支持的指令也越来越多，功能也越来越强.

### 2.1.2 汇编语言
使用0和1这样的机器语言好处是CPU认识，可以直接执行，但是对于程序本身来说，没有可读性，难以维护，容易出错。所以就出现了汇编语言，它用助记符(代替操作码指令，用地址符号代替地址码。**实际是对机器语言的一种映射**，可读性高。

把汇编语言转换为机器语言需要一个叫做`汇编器的工具`。对于目前的CPU厂商，在推出的`CPU指令`时都会同时推出新的汇编器。如果你还在使用老版本的`汇编器`那么只能使用机器码来使用新的指令了。

### 2.1.3  高级语言
汇编语言的出现大大提高了编程效率，但是有一个问题就是**不同CPU的指令集可能不同**，这样就需要为不同的CPU编写不同的汇编程序。于是又出现了高级语言比如C，或者是后来的C++,JAVA,C#。 高级语言把多条汇编指令合成成为了一个表达式，并且去除了许多操作细节（比如堆栈操作，寄存器操作），而是以一种更直观的方式来编写程序，而面向对象的语言的出现使得程序编写更加符合我们的思维方式。**我们不必把尽力放到低层的细节上**，**而更多的关注程序的本身的逻辑的实现**。

对于高级语言来说需要一个编译器来完成高级语言到汇编语言的转换。所以对比不同的CPU结构，只需要有不同编译器和汇编器就能使得我们的程序在不同CPU上都能运行了。

**当CPU的指令集更新后高级语言会有什么影响和变化**？对于目前来说，一般出现了新的指令，会有对应的新的汇编器和编译器。所以编译器可以把一些高级语言的表达式编译成新的汇编指令，这样对于高级来说不会有任何变化； 当然还有一种情况就是高级语言会增加新的语法来对应一些新的汇编语言和指令。但是这种情况出现的几率很小。所以如果编译器不支持新的指令，那么只有只用汇编会来实现了。

### 2.1.4
我们写的程序最终都将变成机器认识的二进制可执行程序，然后加载到内存顺序的执行。从机器码到汇编到高级语言，我们可以看到计算机中无处不在的分层，抽象的思想。不光光是软件，硬件同样适用。

## 2.2 CPU工作原理
现代计算机的大致结构，也知道CPU是按照CPU指令来执行操作，那么就看看CPU的结构和他是如何执行顺序操作的。

### 2.2.1 CPU功能

* **指令控制**： 指令控制也称为程序的顺序控制，控制程序严格按照规定的顺序执行.
* **操作控制**： 将取出的指令的产生一系列的控制信号(微指令)，分别送往相应的部件，从而控制这些部件按指令的要求进行工作。
* **时间控制**： 有些控制信号在时间上有严格的先后顺序，如读取存储器的数据，只有当地址线信号稳定以后，才能通过数据线将所需的数据读出，否则读出的数据是不正确的数据，这样计算机才能有条不紊地工作。
* **数据加工**： 所谓数据加工，就是对数据进行算术运算和逻辑运算处理。 所谓数据加工，就是对数据进行算术运算和逻辑运算处理

以前CPU主要由**运算器**和**控制器**两大部分组成，随着集成电路的发展，目前CPU芯片集成了一些其它逻辑功能部件来扩充CPU的功能，如浮点运算器、内存管理单元、cache和MMX等。下面2张图分别是8086和Pentium CPU的结构图。

![](image/20130828020834562)


对于一个通用的CPU来说，我们只需要关注他的核心部件**算数逻辑单元**和**操作控制单元**。

![](image/20130828020554078)