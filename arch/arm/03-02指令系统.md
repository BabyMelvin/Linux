# ARM指令集分为6类：1.跳转指令，2.数据处理指令，3.加载/存储指令,4.杂项指令,5.伪指令,6.协处理器指令和异常处理指令

## 1.ARM 跳转指令
ARM两种跳转方式：

* 一种使用跳转指令直接跳转
* 另一种直接向PC寄存器赋值实现跳转

ARM分支跳转指令，可以实现向前或向后跳转32M空间。按功能分为4类：

* B:分支指令

指令格式：`B{cond} label`

被限制在±32M的范围

```
;1.无条件跳转
	B  label
	....
label  ...

;2.执行10次循环
	MOV R0,#10
LOOP
	...
	SUBS RO,R0,#1
	BNE LOOP
```
* BL：带链接的分支指令

带链接跳转指令，指令将下一条指令的地址复制到R14(即LR)链接寄存器中，然后跳转到指定的地址运行.

```
	BL DELAY
	BL SUB1;LR<-下一条指令地址，跳转到子程序SUB1处
SUB1
	...
	MOV PC,LR   ;子程序返回
;注意：不应该再进行嵌套，避免覆盖R14导致无法返回
```
* BX：带状态切换的分支指令

带状态切换指令。跳转到Rm指令的地址执行程序：

	*	若Rm的位`[0]`为1，则跳转时自动将CPSR中的标志T置位，将原代码解释位Thumb代码
	*	若Rm的位`[0]`为0，则跳转时自动将CPSR中的标志T复位，原代码解释为ARM代码


* BLX：带连接和状态的分支指令

## 2.ARM数据处理
数据处理的特点：

1. 操作数来源：所有操作数要么来自寄存器，要么来自立即数，不会来自寄存器
2. 操作结果：结果放入到寄存器中，不会写入存储器

数据处理指令大致分为5类：

* 算术运算指令：ADD,ADC,SUB,SBC,RSB,RSC,MUL,MLA,UMULL,UMAL,SMULL,SMLAL
* 逻辑运算指令：AND,ORR,EOR,BIC
* 数据传送指令：MOV,MVN(将operand2位取反传送到目标寄存器Rd中,立即数非法，但取反合法)
* 比较指令CMP，CMN
* 测试指令：TST,TEQ

## 3.ARM存储器访问指令
对存储器访问只能使用加载和存储指令。SWP指将一条存储器和寄存器内容互换的指令，可用于信号量操作
除了RAM操作外，对外围IO、程序数据的访问均要通过`加载/存储`指令进行

基本`加载/存储`指令仅有5条，分为3类：

* LDR和STR，单寄存器`加载/存储`指令
* LDM和STM，多寄存器`加载/存储`指令
* SWP，寄存器和存储数据交互指令

```
LDR R2,[R5]    ;加载R5指定地址上的数据(字)，放入R2中
STR R1,[R0,#0x04]  ;将R1的数据存储到R0+0x04存储单元，R0不变
;B 字节， SH，高16位，符号扩展   H，高16位9扩展
```

## 4.杂项指令
主要由程序状态寄存器操作和中断操作两种类型组成，一共5条指令：

* 1. 状态寄存器操作指令
	* MRS:读程序状态寄存器指令
	* MSR:写程序状态寄存器指令
* 2.异常中断操作指令
	* SWI:软中断
	* BKPT：断点指令(v5T系统)

### 4.1SWI
软中断指令SWI产生软件异常中断，用来实现用户模式到特权模式的切换。它将处理器置于管理(svc)模式，中断矢量地址位0x08：指令格式位`SWI {cond} <24位立即数>`

主要用于用户程序调用操作系统的API，参数传递通常有两种方式:

* 1.指令中的24位立即数指定API号，其他通过寄存器传递
* 2.忽略指令中24位立即数，R0指定API号，其他参数通过其他寄存器传递

```
;第1种，不传递参数
SWI 10       ;中断号为10   
SWI 0x123456 ;中断号为0x123456
;第1种，传递参数
MOV R0,#34
SWI 12

;第2种，不用指令种立即数，软中断号和其他参数都在寄存器中传递

MOV R0,#12   ;准备中断号
MOV R1,#34   ;准备参数
SWI 0        ;进入软中断
```